"use strict";(self.webpackChunkoc_studio_docs=self.webpackChunkoc_studio_docs||[]).push([[619],{3905:function(e,t,n){n.d(t,{Zo:function(){return h},kt:function(){return g}});var i=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=i.createContext({}),d=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},h=function(e){var t=d(e.components);return i.createElement(l.Provider,{value:t},e.children)},c="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},u=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,h=s(e,["components","mdxType","originalType","parentName"]),c=d(n),u=a,g=c["".concat(l,".").concat(u)]||c[u]||p[u]||o;return n?i.createElement(g,r(r({ref:t},h),{},{components:n})):i.createElement(g,r({ref:t},h))}));function g(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,r=new Array(o);r[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[c]="string"==typeof e?e:a,r[1]=s;for(var d=2;d<o;d++)r[d]=n[d];return i.createElement.apply(null,r)}return i.createElement.apply(null,n)}u.displayName="MDXCreateElement"},5799:function(e,t,n){n.r(t),n.d(t,{assets:function(){return h},contentTitle:function(){return l},default:function(){return g},frontMatter:function(){return s},metadata:function(){return d},toc:function(){return c}});var i=n(7462),a=n(3366),o=(n(7294),n(3905)),r=["components"],s={title:"Chat Widget",sidebar_label:"Chat Widget"},l=void 0,d={unversionedId:"channels/channel-chat-widget",id:"channels/channel-chat-widget",title:"Chat Widget",description:"What is the chat widget channel?",source:"@site/docs/channels/channel-chat-widget.md",sourceDirName:"channels",slug:"/channels/channel-chat-widget",permalink:"/docs/channels/channel-chat-widget",draft:!1,editUrl:"https://github.com/xapp-ai/documentation/edit/main/docs/channels/channel-chat-widget.md",tags:[],version:"current",frontMatter:{title:"Chat Widget",sidebar_label:"Chat Widget"},sidebar:"docs",previous:{title:"AWS Lex (V2) Channel",permalink:"/docs/channels/aws-lex"},next:{title:"BETA - Intelligent Search",permalink:"/docs/channels/channel-intelligent-search"}},h={},c=[{value:"What is the chat widget channel?",id:"what-is-the-chat-widget-channel",level:2},{value:"Connecting to a Backend",id:"connecting-to-a-backend",level:2},{value:"Connecting to existing Lex Channel",id:"connecting-to-existing-lex-channel",level:3},{value:"Installing the Widget",id:"installing-the-widget",level:2},{value:"WordPress Plugin",id:"wordpress-plugin",level:3},{value:"Read More",id:"read-more",level:4},{value:"Script Tag",id:"script-tag",level:3},{value:"See Also",id:"see-also",level:4},{value:"React Library",id:"react-library",level:3},{value:"Installation",id:"installation",level:4},{value:"Authenticated Users",id:"authenticated-users",level:2},{value:"Global Variable on window",id:"global-variable-on-window",level:3},{value:"React Parameter",id:"react-parameter",level:3},{value:"Configuring the Widget within Studio",id:"configuring-the-widget-within-studio",level:2},{value:"Share the Widget",id:"share-the-widget",level:3},{value:"Disabling your Widget",id:"disabling-your-widget",level:3},{value:"Modifying the Z-Index",id:"modifying-the-z-index",level:3},{value:"Read More",id:"read-more-1",level:4},{value:"Behavior of Opening URLs",id:"behavior-of-opening-urls",level:3},{value:"Recommendation - Assisted Navigation",id:"recommendation---assisted-navigation",level:4},{value:"Modifying the Host Application based on Widget Interactions",id:"modifying-the-host-application-based-on-widget-interactions",level:2},{value:"Register the Hook",id:"register-the-hook",level:3},{value:"Data on the Response",id:"data-on-the-response",level:3}],p={toc:c},u="wrapper";function g(e){var t=e.components,s=(0,a.Z)(e,r);return(0,o.kt)(u,(0,i.Z)({},p,s,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"what-is-the-chat-widget-channel"},"What is the chat widget channel?"),(0,o.kt)("p",null,"The chat widget is a channel provided by OC Studio that you can customize and embed on your website.  It is built to work alongside other text based input channels with built-in components such as cards, vertical lists, horizontal lists and suggestion chips.  Unique to OC Studio, it also has support for autocomplete suggestions."),(0,o.kt)("p",null,"You can configure nearly every aspect of the widget, including the styles, without needing a developer and is extensible to allow you to add your own custom components."),(0,o.kt)("h2",{id:"connecting-to-a-backend"},"Connecting to a Backend"),(0,o.kt)("p",null,"The chat widget requires a backend for it to communicate with. The widget has two primary modes of communication with a backend, either direct or through a web sockets server. The direct connection is expecting an endpoint that leverages stentor request & response models."),(0,o.kt)("h3",{id:"connecting-to-existing-lex-channel"},"Connecting to existing Lex Channel"),(0,o.kt)("p",null,"If you have an existing Lex Channel with a PostText URL, you can use this as your chat widgets server."),(0,o.kt)("p",null,"When you copy and paste the URL, you must post-fix the PostText URL with ",(0,o.kt)("inlineCode",{parentName:"p"},"/studio"),' and select "Direct Connection". For example, if you have a PostText URL of:'),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"https://kfo7ubarz9t0.execute-api.us-east-1.amazonaws.com/prod\n")),(0,o.kt)("p",null,"Then you want to append ",(0,o.kt)("inlineCode",{parentName:"p"},"/studio")," like so:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"https://kfo7ubarz9t0.execute-api.us-east-1.amazonaws.com/prod/studio\n")),(0,o.kt)("h2",{id:"installing-the-widget"},"Installing the Widget"),(0,o.kt)("p",null,"There are three primary ways to install the widget on a website; WordPress plugin (where applicable), a script tag or through our React based library.  The script tag is quick and can typically be done without a developer and the React library will require a developer to integrate it with an existing web application.  With the script tag method, you are limited to the standard chat button component and widget overlayed on your content and the React library allow gives you much more control on how it is displayed."),(0,o.kt)("h3",{id:"wordpress-plugin"},"WordPress Plugin"),(0,o.kt)("p",null,"We provide a WordPress plugin that makes it easy to install the chat widget and intelligent search bar.  If you have a WordPress site, this is our recommended approach."),(0,o.kt)("h4",{id:"read-more"},"Read More"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://wordpress.org/plugins/oc-studio-integration/"},"OC Studio Integration Plugin")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/docs/channels/wordpress-plugin"},"How to install the WordPress Plugin"))),(0,o.kt)("h3",{id:"script-tag"},"Script Tag"),(0,o.kt)("p",null,"To install the widget with a script tag, go to your chat widget channel within OC Studio and click the puzzle piece icon in the header. Click on the text to copy it to your clipboard."),(0,o.kt)("p",null,"It will look something like this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},'<script\n  id="xapp-js"\n  src="https://widget.xapp.ai/xapp-chat-widget.js?key=your-unique-key"\n><\/script>\n')),(0,o.kt)("p",null,"The loaded script is self-contained and does not rely on loading of other elements so it can be placed near the bottom of the page to ensure nothing is blocking on load."),(0,o.kt)("p",null,"Add the copied snippet just inside the ",(0,o.kt)("inlineCode",{parentName:"p"},"</body>")," tag on the site you want the widget to appear on."),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("p",{parentName:"admonition"},"The script itself does not make any blocking network calls and does not depend on any other elements or scripts to load so you can safely place it anywhere. Placing it in right before the ",(0,o.kt)("inlineCode",{parentName:"p"},"</body>")," tag as opposed to within the ",(0,o.kt)("inlineCode",{parentName:"p"},"<head>")," tags provides a slight increase in page load.")),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("p",{parentName:"admonition"},"The script is hosted on a CDN however when making configuration updates, the first time loading the widget after a save will be slower than all subsequent calls as the cached scripted is invalidated and the cache updated.  ")),(0,o.kt)("h4",{id:"see-also"},"See Also"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/docs/channels/widget/install-wordpress"},"Installing the Widget on Wordpress Sites"))),(0,o.kt)("h3",{id:"react-library"},"React Library"),(0,o.kt)("p",null,"It is also possible to embed the widget in a React based web application, this will provide you with a more integrated look and feel however requires you to build and inject your own configuration."),(0,o.kt)("h4",{id:"installation"},"Installation"),(0,o.kt)("p",null,"Add to your project:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"npm i @xapp/chat-widget redux-thunk redux react-redux --production\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},'import { Chat as ChatWidget, WidgetEnv } from "@xapp/chat-widget";\nimport "@xapp/chat-widget/dist/index.css";\n\nconst config: WidgetEnv = {\n    connection: {\n        serverUrl: "",\n        type: "direct"\n    },\n};\n\nfunction RenderWidget() {\n    return <ChatWidget config={config} mode={"docked"} />;\n}\n')),(0,o.kt)("p",null,"The config has all the same parameters configured on the chat widget channel page however without the GUI for setting them.  "),(0,o.kt)("p",null,"When in ",(0,o.kt)("inlineCode",{parentName:"p"},"docked")," mode the widget will fill the space, height & width, given to it and be responsive to changes in dimensions."),(0,o.kt)("h2",{id:"authenticated-users"},"Authenticated Users"),(0,o.kt)("p",null,"For applications where the widget is installed behind a login, you can set the user's unique user ID and access token on the widget so it is passed through to the assistant application.  It can then be used to retreive information specific to the authenticated user.  "),(0,o.kt)("p",null,"The user ID and accessToken will be on every request to your applications runtime."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"\n    /**\n     * Optional ID that will be used for the user.  If not prevent\n     */\n    readonly userId?: string;\n    /**\n     * Optional access token that is passed to the backend and used for authenticated API calls.  This is for logged in users and is passed\n     * through on all requests to the assistant backend.\n     */\n    readonly accessToken?: string;\n    /**\n     * Optional attributes to append to each request.  \n     */\n    readonly attributes?: Record<string, string>;\n")),(0,o.kt)("p",null,"There are two primary methods to provide this information to the widget, a global variables on the browser's window object or by a React parameter (requires custom installation method)."),(0,o.kt)("h3",{id:"global-variable-on-window"},"Global Variable on window"),(0,o.kt)("p",null,"You can configure the widget by modifying an object at ",(0,o.kt)("inlineCode",{parentName:"p"},'window["xaConfig"]'),".  The widget will look at this field on bootstraping.  To set the user's ID and access token:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},'window["xaConfig"] = {\n    userId: "123",\n    accessToken: "abc"\n}\n')),(0,o.kt)("h3",{id:"react-parameter"},"React Parameter"),(0,o.kt)("p",null,"If you have installed the widget as part of your React application using the React library, you can append the user ID and access token as part of the configuration."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},'import { Chat as ChatWidget, WidgetEnv } from "@xapp/chat-widget";\nimport "@xapp/chat-widget/dist/index.css";\n\nconst config: WidgetEnv = {\n    connection: {\n        serverUrl: "",\n        type: "direct"\n    },\n    userId: "abc",\n    accessToken: "123",\n    // Custom attributes that will be be appended on every request\n    attributes: {\n        foo: "bar"\n    }\n};\n\nfunction RenderWidget() {\n    return <ChatWidget config={config} mode={"docked"} />;\n}\n')),(0,o.kt)("h2",{id:"configuring-the-widget-within-studio"},"Configuring the Widget within Studio"),(0,o.kt)("p",null,"If you are leveraging the script tag installation, you can configure the chat widget in OC Studio.  Leverage the split column view with the settings on the left and the widget preview on the right to make changes to parts of the widget and see it updated immediately before saving it.  Saving it will then update the configuration and you can preview it live with the preview link in the header. "),(0,o.kt)("h3",{id:"share-the-widget"},"Share the Widget"),(0,o.kt)("p",null,"The preview link, found in the header of your chat widget channel configuration page, can be used to share the widget externally without requiring a login.  "),(0,o.kt)("h3",{id:"disabling-your-widget"},"Disabling your Widget"),(0,o.kt)("p",null,"You can disable the widget from being displayed after installation or when shared through the preview link by clicking the power button in the header of your chat widget channel configuration page.  "),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"disable the widget",src:n(999).Z,width:"1319",height:"669"})),(0,o.kt)("h3",{id:"modifying-the-z-index"},"Modifying the Z-Index"),(0,o.kt)("p",null,"The z-index controls the level with which elements on a webpage are displayed.  Elements with higher z-index are displayed on top of elements with a lower z-index when they take up the same spot on the page.  If you open the widget and you see other parts of the website on top of the widget, you may need to adjust the z-index to make sure it is on top of the conflicting components."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"modify the z-index",src:n(7562).Z,width:"1233",height:"926"})),(0,o.kt)("h4",{id:"read-more-1"},"Read More"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/en-US/docs/Web/CSS/z-index"},"z-index"))),(0,o.kt)("h3",{id:"behavior-of-opening-urls"},"Behavior of Opening URLs"),(0,o.kt)("p",null,"Hyperlinks will be surfaced from your widget through suggestion chips, list items and within content itself.  You can change the behavior of how they open and even set policies to define how some specific URLs open. "),(0,o.kt)("h4",{id:"recommendation---assisted-navigation"},"Recommendation - Assisted Navigation"),(0,o.kt)("p",null,"An assisted navigation configuration will open links the widget is installed on in the same tab and others in a new tab.  This will allow the user to ask the widget questions, get answers and navigate to the answer while also keeping the widget open.  "),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"assisted navigation",src:n(4539).Z,width:"1019",height:"506"})),(0,o.kt)("p",null,"Set the default to be New tab and then add a new policy that contains your website and its TLD and set the behavior to same window.  Any link that matches the URL regex policy will then open in the same window and all those that don't will open in a new tab."),(0,o.kt)("h2",{id:"modifying-the-host-application-based-on-widget-interactions"},"Modifying the Host Application based on Widget Interactions"),(0,o.kt)("p",null,"During some interactions with the virtual assistant through the widget you may want to change more than just the ",(0,o.kt)("a",{parentName:"p",href:"/"},"URL")," and modifying specific elements on the page the user is on.  You can achieve this by passing in a hook to the ",(0,o.kt)("inlineCode",{parentName:"p"},"WidgetEnv")," config that is passed to the widget and then leveraging the custom ",(0,o.kt)("inlineCode",{parentName:"p"},"data")," field on the Response sent to the widget.  "),(0,o.kt)("h3",{id:"register-the-hook"},"Register the Hook"),(0,o.kt)("p",null,"Add the ",(0,o.kt)("inlineCode",{parentName:"p"},"hooks")," object with the ",(0,o.kt)("inlineCode",{parentName:"p"},"onResponse")," function to your ",(0,o.kt)("inlineCode",{parentName:"p"},"WidgetEnv")," config."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},'import { Chat as ChatWidget, WidgetEnv } from "@xapp/chat-widget";\nimport "@xapp/chat-widget/dist/index.css";\n// This is important\nimport { Response } from "stentor-models";\n\nconst config: WidgetEnv = {\n    connection: {\n        serverUrl: "",\n        type: "direct"\n    },\n    hooks: {\n        onResponse: (response: Response) => {\n            console.log(\'Hook.onResponse\');\n            console.log(response);\n            console.log(response.data);\n        }\n    }\n};\n\nfunction RenderWidget() {\n    return <ChatWidget config={config} mode={"docked"} />;\n}\n')),(0,o.kt)("h3",{id:"data-on-the-response"},"Data on the Response"),(0,o.kt)("p",null,"Within your custom handler, for responses that you want to then pass information to the widget's host application, you can set any metadata on the response using the ",(0,o.kt)("inlineCode",{parentName:"p"},".data")," field.  The widget will still display the output and display items, the entire response will be sent to the ",(0,o.kt)("inlineCode",{parentName:"p"},"onResponse")," hook and you can then parse the data field."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},'const response = getResponse(this, request, context);\n\nresponse.data = {\n    ["key"]: "123abc",\n    ["type"]: "custom request"\n};\n\ncontext.response.respond(response);\n')),(0,o.kt)("p",null,"You can define your own messaging protocol and append the metadata to the data field."))}g.isMDXComponent=!0},7562:function(e,t,n){t.Z=n.p+"assets/images/widget-change-z-index-55215750fbff749c02687ab9495f16ce.gif"},4539:function(e,t,n){t.Z=n.p+"assets/images/widget-url-behavior-assisted-navigation-44a93ab2e456c62abdc14c8b56c2ee5b.png"},999:function(e,t,n){t.Z=n.p+"assets/images/disable-the-widget-4657bda0add26c95da8d01109886953d.gif"}}]);