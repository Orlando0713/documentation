"use strict";(self.webpackChunkoc_studio_docs=self.webpackChunkoc_studio_docs||[]).push([[2097],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return h}});var a=n(7294);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,l=function(e,t){if(null==e)return{};var n,a,l={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(l[n]=e[n]);return l}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}var u=a.createContext({}),s=function(e){var t=a.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},c=function(e){var t=s(e.components);return a.createElement(u.Provider,{value:t},e.children)},p="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,l=e.mdxType,o=e.originalType,u=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),p=s(n),d=l,h=p["".concat(u,".").concat(d)]||p[d]||m[d]||o;return n?a.createElement(h,r(r({ref:t},c),{},{components:n})):a.createElement(h,r({ref:t},c))}));function h(e,t){var n=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var o=n.length,r=new Array(o);r[0]=d;var i={};for(var u in t)hasOwnProperty.call(t,u)&&(i[u]=t[u]);i.originalType=e,i[p]="string"==typeof e?e:l,r[1]=i;for(var s=2;s<o;s++)r[s]=n[s];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},7213:function(e,t,n){n.r(t),n.d(t,{assets:function(){return c},contentTitle:function(){return u},default:function(){return h},frontMatter:function(){return i},metadata:function(){return s},toc:function(){return p}});var a=n(7462),l=n(3366),o=(n(7294),n(3905)),r=["components"],i={title:"AWS Lex (V2) Channel",sidebar_label:"AWS Lex (V2) Channel",slug:"/channels/aws-lex"},u=void 0,s={unversionedId:"channels/channel-lex",id:"channels/channel-lex",title:"AWS Lex (V2) Channel",description:"Overview",source:"@site/docs/channels/channel-lex.md",sourceDirName:"channels",slug:"/channels/aws-lex",permalink:"/docs/channels/aws-lex",draft:!1,editUrl:"https://github.com/xapp-ai/documentation/edit/main/docs/channels/channel-lex.md",tags:[],version:"current",frontMatter:{title:"AWS Lex (V2) Channel",sidebar_label:"AWS Lex (V2) Channel",slug:"/channels/aws-lex"},sidebar:"docs",previous:{title:"Channels",permalink:"/docs/channels/"},next:{title:"Chat Widget",permalink:"/docs/channels/channel-chat-widget"}},c={},p=[{value:"Overview",id:"overview",level:2},{value:"Requirements",id:"requirements",level:2},{value:"Setup",id:"setup",level:2},{value:"Create a Lex V2 Bot (optional)",id:"create-a-lex-v2-bot-optional",level:3},{value:"Create Lex V2 Channel",id:"create-lex-v2-channel",level:3},{value:"Create IAM Policy for Studio Management",id:"create-iam-policy-for-studio-management",level:3},{value:"Create an IAM Role for Studio Management",id:"create-an-iam-role-for-studio-management",level:3},{value:"Configuration",id:"configuration",level:2},{value:"Bot Name",id:"bot-name",level:3},{value:"PostText Lex URL",id:"posttext-lex-url",level:3},{value:"Fulfillment Lambda ARN",id:"fulfillment-lambda-arn",level:3},{value:"Management Role",id:"management-role",level:3},{value:"Management Role External ID",id:"management-role-external-id",level:3}],m={toc:p},d="wrapper";function h(e){var t=e.components,i=(0,l.Z)(e,r);return(0,o.kt)(d,(0,a.Z)({},m,i,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"overview"},"Overview"),(0,o.kt)("p",null,"The AWS Lex channel provides you two options for integration; either with fulfillment where all requests first go through Lex or as a pure NLU without fulfillment defined in Lex and instead Lex is called from within Stentor."),(0,o.kt)("h2",{id:"requirements"},"Requirements"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"AWS Account and user with appropriate permissions to:",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"To create a Lex Bot"),(0,o.kt)("li",{parentName:"ul"},"To create IAM Roles")))),(0,o.kt)("h2",{id:"setup"},"Setup"),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},'This is a new channel currently in beta and is subject to change.  You will need to enable it in your app\'s settings to access it on the "Add Channel" dialog.')),(0,o.kt)("h3",{id:"create-a-lex-v2-bot-optional"},"Create a Lex V2 Bot (optional)"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"In your AWS console, create a Lex V2 bot",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://us-east-1.console.aws.amazon.com/lexv2/home?region=us-east-1#createBot"},"Create a bot in us-east-1")))),(0,o.kt)("li",{parentName:"ol"},'Select "Create a blank bot"'),(0,o.kt)("li",{parentName:"ol"},"Add a name, we recommend the appId of your application in Studio",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/docs/development/development-faqs#how-do-i-find-my-application-id"},"How do you find your application ID?")))),(0,o.kt)("li",{parentName:"ol"},'Select "Create a role with basic Amazon Lex Permissions"'),(0,o.kt)("li",{parentName:"ol"},"Take note of the ID of your newly created bot",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"You will add it to the policy we create below"))),(0,o.kt)("li",{parentName:"ol"},"Delete the first intent that is created for you automatically.")),(0,o.kt)("h3",{id:"create-lex-v2-channel"},"Create Lex V2 Channel"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"In Studio within your application, select Publish --\x3e Channels"),(0,o.kt)("li",{parentName:"ol"},"Click the + button in the Channels header"),(0,o.kt)("li",{parentName:"ol"},'Select "Amazon Lex V2"')),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Note: If you don't see this option, you may need to first enable this channel in your app's settings")),(0,o.kt)("h3",{id:"create-iam-policy-for-studio-management"},"Create IAM Policy for Studio Management"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Create IAM Policy"),(0,o.kt)("li",{parentName:"ol"},"Click JSON tab and copy paste the following:",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Update the resource ARN with your region, ",(0,o.kt)("inlineCode",{parentName:"li"},"region"),", AWS account ",(0,o.kt)("inlineCode",{parentName:"li"},"account"),", and bot ID ",(0,o.kt)("inlineCode",{parentName:"li"},"bot-id")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Note:")," ",(0,o.kt)("inlineCode",{parentName:"li"},"bot-id")," is different from the name, it is alphanumeric.")))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "Version": "2012-10-17",\n    "Statement": [\n        {\n            "Effect": "Allow",\n            "Action": [\n                "iam:PassRole"\n            ],\n            "Resource": "arn:aws:iam::<account>:role/<name-of-management-role-being-created>"\n        },\n        {\n            "Effect": "Allow",\n            "Action": [\n                "lex:Build*",\n                "lex:Create*",\n                "lex:Delete*",\n                "lex:Describe*",\n                "lex:Get*",\n                "lex:List*",\n                "lex:Put*",\n                "lex:Recognize*",\n                "lex:Search*",\n                "lex:Start*",\n                "lex:Stop*",\n                "lex:Tag*",\n                "lex:Update*",\n                "lex:Untag*"\n            ],\n            "Resource": [\n                "arn:aws:lex:<region>:<account>:bot/*",\n                "arn:aws:lex:<region>:<account>:bot-alias/*",\n            ]\n        },\n        {\n            "Effect": "Allow",\n            "Action": [\n                "lex:CreateUploadUrl",\n                "lex:ListBuiltInSlotTypes",\n                "lex:ListBots",\n                "lex:ListBuiltInIntents",\n                "lex:ListImports",\n                "lex:ListExports"\n            ],\n            "Resource": "*"\n        }\n    ]\n}\n')),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Add optional tags"),(0,o.kt)("li",{parentName:"ol"},"For policy name we recommend ",(0,o.kt)("inlineCode",{parentName:"li"},"xapp-studio-lex-management-{appId}")," or similar.")),(0,o.kt)("h3",{id:"create-an-iam-role-for-studio-management"},"Create an IAM Role for Studio Management"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Create IAM Role")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Select AWS account")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Select 'Another AWS account' and enter account ID: ",(0,o.kt)("inlineCode",{parentName:"p"},"204595997473")),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"If you are running a single tenant version with Lex in the same account, this will be the account number where your Studio instance is deployed."))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Check 'Require external ID', paste in the external ID from your newly created Lex channel under setting \"Management Role External ID\""),(0,o.kt)("p",{parentName:"li"},(0,o.kt)("img",{alt:"external role",src:n(8985).Z,width:"1265",height:"865"}))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},'Back in the AWS Console, click "Next"'),(0,o.kt)("p",{parentName:"li"},(0,o.kt)("img",{alt:"new role",src:n(7811).Z,width:"1436",height:"981"}))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},'Search for you policy you created above and select it, click "Next"')),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"For role name we recommend ",(0,o.kt)("inlineCode",{parentName:"p"},"xapp-studio-lex-management-{appId}"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"When you create it, click ",(0,o.kt)("inlineCode",{parentName:"p"},"View Role")," in the green banner at the top.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},'Copy the role\'s ARN and paste it to the channel under "Management Role"'))),(0,o.kt)("h2",{id:"configuration"},"Configuration"),(0,o.kt)("h3",{id:"bot-name"},"Bot Name"),(0,o.kt)("p",null,"The name of the bot you will be managing with Studio.  This is not the ID but is the name."),(0,o.kt)("h3",{id:"posttext-lex-url"},"PostText Lex URL"),(0,o.kt)("p",null,"The PostFix URL is generated for you automatically when you leverage the provided CloudFormation script for deployment. It is a lambda exposed through API Gateway that calls your Lex bot's ",(0,o.kt)("a",{parentName:"p",href:"https://docs.aws.amazon.com/lex/latest/dg/API_runtime_PostText.html"},"PostText API"),". The PostText is part of the Lex Runtime Service that receives user input and returns the bot's response. The PostText URL takes Stentor requests and then returns Stentor responses."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Read More")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/docs/development/posttext-lambda"},"PostText Lambda"))),(0,o.kt)("h3",{id:"fulfillment-lambda-arn"},"Fulfillment Lambda ARN"),(0,o.kt)("p",null,"Optional, if you provide this it will set it as the fulfillment ARN for each intent.  It will then be called whenever an intent is resolved."),(0,o.kt)("h3",{id:"management-role"},"Management Role"),(0,o.kt)("p",null,"The role, as described above in configuration, this is the ARN for the IAM Role you setup to allow management by Studio."),(0,o.kt)("h3",{id:"management-role-external-id"},"Management Role External ID"),(0,o.kt)("p",null,"Readonly, use this when setting up your management role.  It helps further secure the connection betwen AWS accounts."))}h.isMDXComponent=!0},7811:function(e,t,n){t.Z=n.p+"assets/images/aws-iam-role-lex-v2-management-9756aeeddfd02b4cd0d3995e9aeb4405.png"},8985:function(e,t,n){t.Z=n.p+"assets/images/lex-v2-management-external-id-9f60af350d559b9952bd7847f607aa64.png"}}]);